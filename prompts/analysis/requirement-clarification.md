# 需求澄清 Prompt Template

用于澄清和细化需求的 prompt 模板。

## 场景

- 需求描述模糊或不完整
- 需要从产品经理/用户获取更多信息
- 需要识别需求中的假设和风险
- 需要将需求转化为技术规范

## Prompt 模板

### 基础模板

```markdown
我收到了一个需求，但信息不够完整，请帮我分析并生成澄清问题。

## 需求描述
[粘贴原始需求]

## 已知信息
[如果有，列出已知的信息、约束、背景]

## 请分析：
1. 需求的模糊或不明确之处
2. 缺少的关键信息
3. 可能的假设风险
4. 建议询问的问题（按优先级排序：Critical/High/Medium/Low）

对每个问题，说明：
- 为什么需要问
- 如果不问可能导致的后果
- 如何验证得到的答案
```

---

### 进阶模板（适用于复杂需求）

```markdown
请帮我澄清以下需求：

## 需求描述
[需求内容]

## 背景信息
- [业务背景]
- [用户角色]
- [使用场景]

## 请提供：
1. 需求完整性检查
   - 缺少哪些关键信息？
   - 是否有矛盾或不一致的地方？

2. 假设识别
   - 需求中可能隐藏的假设
   - 哪些假设需要验证？

3. 澄清问题列表
   - Critical（必须问）：不问可能导致方向错误
   - High（应该问）：不问可能导致返工
   - Medium（可以问）：优化需求细节
   - Low（可选）：完善边缘场景

4. 需求分类（MoSCoW）
   - Must have：核心功能
   - Should have：重要但可延后
   - Could have：锦上添花
   - Won't have：明确不做

5. 验收标准建议
   - 如何判断需求已完成？
   - 如何测试？
```

---

## 实际例子

### 例子 1：优化搜索功能（模糊需求）

**输入：**
```
需求：优化搜索功能，让用户更快找到想要的内容
```

**AI输出：**

```markdown
## 需求完整性检查

### 缺少的关键信息
1. **当前性能数据**
   - 当前搜索响应时间是多少？
   - 用户抱怨的具体场景是什么？

2. **优化目标**
   - "更快"的具体指标是多少？（如：从5秒降到1秒）
   - 期望的用户体验改善？

3. **搜索范围**
   - 搜索哪些内容？（商品、文章、用户...）
   - 是否涉及全文搜索、模糊搜索、过滤？

### 假设识别
1. ❓ 假设：当前搜索用的是数据库LIKE查询
   - 风险：如果已经用了ES，优化方向完全不同

2. ❓ 假设：优化主要针对响应时间
   - 风险：用户可能更关心结果相关性

### 澄清问题列表

#### Critical（必须问）
1. **当前搜索性能基准是多少？**
   - 为什么：影响优化策略选择
   - 后果：如果已经很快了，优化相关性更重要
   - 验证：查看APM数据

2. **优化的主要目标是什么？速度？准确性？易用性？**
   - 为什么：不同目标对应不同方案
   - 后果：可能优化了错误的方向

#### High（应该问）
3. **搜索功能的主要使用场景是什么？**
   - 为什么：影响功能优先级
   - 后果：可能优化了不常用的场景

4. **有多少数据量？每天有多少搜索请求？**
   - 为什么：影响技术选型（ES vs Solr vs 数据库）
   - 后果：技术方案选错导致性能不达标

#### Medium（可以问）
5. **是否需要支持高级搜索（如：按时间、价格、类别过滤）？**
   - 为什么：影响复杂度
   - 后果：需求蔓延

### 验收标准建议
- 搜索响应时间 < 1秒（p95）
- 搜索结果相关性通过用户评分 > 4.0/5.0
- 支持1000并发搜索
```

---

### 例子 2：用户通知系统（复杂需求）

**输入：**
```
需求：实现用户通知系统，支持邮件、短信、推送
```

**AI输出：**

```markdown
## 需求完整性检查

### 缺少的关键信息
1. **通知触发条件**
   - 什么时候发送通知？
   - 用户如何订阅/取消？

2. **消息内容**
   - 通知内容是固定的还是可配置？
   - 是否支持模板？

3. **发送优先级**
   - 是否需要实时发送？
   - 批量发送策略？

4. **失败处理**
   - 发送失败如何处理？
   - 是否需要重试？

### 假设识别
1. ❓ 假设：所有通知都需要实时发送
   - 风险：高并发场景下性能问题

2. ❓ 假设：所有用户都能收到所有通知
   - 风险：用户可能被骚扰

### 澄清问题列表

#### Critical（必须问）
1. **通知触发条件有哪些？**
   - 为什么：影响设计和实现
   - 后果：遗漏场景导致功能不全

2. **用户如何管理通知偏好？**
   - 为什么：影响UX设计
   - 后果：用户体验差

3. **是否需要国际化（多语言）？**
   - 为什么：影响技术方案
   - 后果：后期改造成本高

#### High（应该问）
4. **通知消息是否需要支持自定义模板？**
   - 为什么：运营需求
   - 后果：无法灵活调整消息

5. **发送失败后如何处理？重试几次？间隔多久？**
   - 为什么：可靠性要求
   - 后果：通知丢失影响业务

#### Medium（可以问）
6. **是否需要通知历史记录？**
   - 为什么：审计和排查问题
   - 后果：无法追踪通知发送情况

### MoSCoW 分类

**Must have：**
- 邮件通知
- 用户订阅/取消功能
- 发送失败重试（3次）

**Should have：**
- 短信通知
- 通知模板管理
- 发送日志

**Could have：**
- 推送通知
- 通知分组
- 定时发送

**Won't have：**
- 实时通知（使用队列异步发送）

### 验收标准建议
- 用户可以订阅/取消通知类型
- 通知在5分钟内发送成功（p95）
- 发送失败自动重试3次
- 支持中英文模板
```

---

### 例子 3：导出Excel功能（简单需求）

**输入：**
```
需求：用户可以导出数据为Excel
```

**AI输出：**

```markdown
## 需求完整性检查

### 缺少的关键信息
1. **导出哪些数据？**
   - 全部数据还是筛选后的数据？

2. **数据量范围**
   - 最大导出多少行？
   - 是否需要分批导出？

3. **Excel格式**
   - 是否需要样式（颜色、字体）？
   - 是否需要多Sheet？

4. **权限控制**
   - 谁可以导出？
   - 是否需要审计？

### 澄清问题列表

#### Critical（必须问）
1. **导出哪些表的数据？导出哪些字段？**
   - 为什么：核心功能定义
   - 后果：导出内容不符合需求

2. **最大导出数据量是多少？**
   - 为什么：性能和用户体验
   - 后果：导出超时或文件过大

#### High（应该问）
3. **导出的Excel需要什么格式？（样式、多Sheet、图表）**
   - 为什么：影响实现复杂度
   - 后果：过度设计或功能不足

#### Medium（可以问）
4. **导出后是否需要发送邮件？**
   - 为什么：用户体验
   - 后果：大文件导出用户体验差

### 验收标准建议
- 支持导出当前筛选结果
- 最大支持10万行导出
- 导出时间 < 30秒
- Excel包含表头和基本样式
```

---

## 关键原则

### 1. 优先级分类

用优先级驱动澄清：
- **Critical**: 不问就不能开始
- **High**: 不问就可能导致返工
- **Medium**: 优化细节
- **Low**: 可选，有时间再问

### 2. 用例子替代抽象

❌ Bad: "需要用户友好"
✅ Good: "错误提示应该是中文，包含具体原因和建议操作"

### 3. 验证假设

识别需求中的隐含假设，主动验证：
- 技术假设（现有架构、性能）
- 业务假设（用户行为、使用场景）
- 约束假设（时间、资源）

### 4. 提供验收标准

在澄清时同时建议验收标准：
- 功能验收标准
- 性能验收标准
- 测试标准

---

## 实战技巧

### 技巧1：多问"为什么"

不要只问"是什么"，要问"为什么需要这个"

```
Q: 为什么需要导出Excel而不是CSV？
A: 因为用户需要在Excel里做数据分析，需要公式和图表
→ 结论：需要支持基本样式，不只是数据导出
```

---

### 技巧2：用场景驱动

让用户描述具体使用场景：

```
Q: 请描述一个用户使用导出功能的典型场景
A: 市场部每月导出销售数据，在Excel里做环比分析
→ 结论：需要按月筛选，导出格式便于对比分析
```

---

### 技巧3：用原型验证

对于复杂需求，建议用原型/草图：

```
Q: 能否提供一个导出功能的界面草图或参考竞品？
→ 可以快速对齐理解，减少误解
```

---

## 输出格式模板

```markdown
# 需求澄清报告

## 需求概述
[简要描述需求]

## 完整性检查
- [ ] 功能需求明确
- [ ] 非功能需求明确（性能、安全、可用性）
- [ ] 约束条件清楚
- [ ] 验收标准可测

## 缺失信息
1. [缺失项]
   - 影响：[为什么需要]
   - 建议：[如何补充]

## 澄清问题
### Critical
1. [问题]

### High
...

## 建议的验收标准
- [ ] [标准1]
- [ ] [标准2]

## 风险识别
1. [风险]
   - 概率：[高/中/低]
   - 影响：[严重/中等/轻微]
```

---

## 参考资料

### 方法论
- **5W1H** - What, Why, When, Where, Who, How
- **MoSCoW** - 优先级管理
- **INVEST** - 用户故事质量标准

### 相关文档
- [01-requirement-analysis.md](../phases/01-requirement-analysis.md) - 需求分析方法论
- [bad-vs-good-prompts.md](../examples/bad-vs-good-prompts.md) - Prompt质量对比
