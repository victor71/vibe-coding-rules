# New Feature Prompt Template

实现新功能的 prompt 模板。

## 场景

- 实现新功能
- 添加新 API 端点
- 集成新服务
- 添加 UI 组件

## Prompt 模板

```
实现新功能：[功能描述]

要求：
- [详细的需求列表]

技术规范：
- [技术栈、API、约束]

实施步骤：
1. [高层步骤1]
2. [高层步骤2]
3. [高层步骤3]

交付物：
- 功能实现
- 单元测试
- 集成测试（如适用）
- 文档（API文档、用户指南）
- 更新 CHANGELOG.md

上下文：
- [如何融入现有代码库]
- [对其他模块的依赖]
```

## 实际例子

### 例子：实现用户通知系统

```
实现用户通知系统。

要求：
1. 用户可以订阅不同的通知类型（邮件、推送、短信）
2. 管理员可以发送广播通知
3. 用户可以管理他们的通知偏好
4. 通知排队并异步发送
5. 失败的通知重试

技术规范：
- 使用 Redis 作为队列
- 使用现有的邮件服务（在 utils/email.py 中）
- 使用 Firebase Cloud Messaging 进行推送
- 使用 Twilio 发送短信
- 所有操作的 REST API 端点
- 用于实时更新的 WebSocket

实施步骤：
1. 设计通知 schema（models/）
2. 实现通知服务（services/notifications/）
3. 创建 REST API 端点（api/notifications/）
4. 实现队列工作器（workers/）
5. 添加 WebSocket 支持（websockets/）
6. 构建管理界面
7. 编写全面的测试
8. 记录 API 端点

交付物：
- 包含所有功能的完整实现
- 每个组件的单元测试
- API 的集成测试
- docs/api.md 中的 API 文档
- CHANGELOG.md 条目

上下文：
- 这与现有的身份验证系统集成
- 尽可能使用现有的数据库模型
- 必须是生产就绪的，具有错误处理和日志记录
```

## 实现最佳实践

### 1. 明确需求
```
✅ 好：
用户可以上传最大 10MB 的图片。必须验证文件类型（JPG、PNG、GIF）。
调整到最大 1920x1080。存储到 S3。

❌ 差：
实现图片上传。
```

### 2. 分步实施
```
✅ 好：
阶段 1：数据库 schema 和模型
阶段 2：存储服务（S3 集成）
阶段 3：API 端点
阶段 4：验证和安全
阶段 5：测试和文档

❌ 差：
一次性构建所有内容。
```

### 3. 测试覆盖
```
✅ 好：
- 每个函数的单元测试
- API 的集成测试
- 边缘情况测试（无效文件、超大文件）
- 错误处理测试

❌ 差：
写一些测试。
```

### 4. 文档完整
```
✅ 好：
- 带示例的 API 文档
- 配置指南
- 部署说明
- 带迁移说明的 CHANGELOG 条目

❌ 差：
功能完成。
```

## 复杂功能的分阶段 Prompt

对于大型功能，使用多个 prompt：

### Phase 1: 设计
```
设计 [功能] 的架构。

提供：
1. 数据库 schema
2. 文件结构
3. API 端点
4. 关键组件及其职责
5. 对现有代码的依赖

先不要写代码，只需设计。
```

### Phase 2: 核心实现
```
基于设计实现核心组件。

专注于：
- 模型和数据库 schema
- 核心业务逻辑
- 存储层

跳过：API 端点、测试、文档暂时跳过。
```

### Phase 3: API 和测试
```
实现 REST API 和测试。

基于核心实现，添加：
- API 端点（POST/GET/PUT/DELETE）
- 输入验证
- 错误处理
- 单元测试
- 集成测试
```

### Phase 4: 文档和清理
```
完成功能：

1. 编写全面的 API 文档
2. 在需要的地方添加代码注释
3. 更新 CHANGELOG.md
4. 添加任何缺失的测试
5. 代码清理（格式化、命名）
```

## 集成第三方服务

```
集成 [服务名称] 用于 [目的]。

要求：
- [集成应该做什么]
- [配置需求]
- [错误处理要求]

服务详情：
- API：[API 文档链接或描述]
- 身份验证：[如何身份验证]
- 速率限制：[如有]
- 定价/配额：[如相关]

实施：
1. 阅读服务文档（如本地可用）
2. 设计集成架构
3. 实现服务客户端
4. 添加 API 密钥配置
5. 实现重试逻辑
6. 添加错误处理和日志记录
7. 编写测试（对外部调用使用 mocks）
8. 记录配置和用法
```
